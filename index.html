<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width" />
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  <meta name="description" content="Escape Game en plein air - DÃ©fiez-vous dans le terrain de jeu de la nature" />
  <title>Jeu d'Ã‰vasion Aventure en Plein Air</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet" />

  <!-- Your existing CSS bundle if needed -->
  <!-- <link rel="stylesheet" href="./_astro/index.BvZmKtI1.css" /> -->

  <style>
    :root{
      --spacing: 8px;
      --white:#fff; --cream:#fff8dc; --forest-green:#1b4332; --pine-green:#355e3b;
      --mountain-blue:#3b82f6; --sunset-orange:#ea580c; --accent-orange:#fb923c;
      --dark-stone:#334155; --moss-green:#8fbc8b;
    }
    body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial}
    .content{max-width:1100px;margin:0 auto;padding:calc(var(--spacing)*6)}
    .header-section h1{font-family:"Playfair Display",serif;color:var(--forest-green);}
    .description{max-width:850px;color:#1f2937}

    /* CTA section (kept from your style, slightly simplified) */
    .cta-section {
      text-align: center;
      background: linear-gradient(135deg, var(--forest-green) 0%, var(--pine-green) 30%, var(--mountain-blue) 70%, var(--sunset-orange) 100%);
      border-radius: calc(var(--spacing) * 2);
      padding: calc(var(--spacing) * 6);
      box-shadow: 0 16px 48px rgba(27, 67, 50, 0.4);
      border: 2px solid rgba(255, 255, 255, 0.1);
      color: var(--white);
    }
    .price-badge {
      display: inline-block;
      background: linear-gradient(135deg, var(--cream) 0%, var(--white) 100%);
      color: var(--forest-green);
      padding: calc(var(--spacing) * 3) calc(var(--spacing) * 6);
      border-radius: calc(var(--spacing) * 3);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3), inset 0 1px rgba(255, 255, 255, 0.8);
      border: 3px solid var(--sunset-orange);
      cursor: pointer;
      transition: transform .2s ease, box-shadow .2s ease;
      font-family: Inter, sans-serif;
    }
    .price-badge:hover { transform: translateY(-2px); box-shadow: 0 12px 35px rgba(0,0,0,0.35); }
    .price-text { font-size: 18px; font-weight: 500; display: block; }
    .price-amount { font-size: 48px; font-weight: 700; line-height:1; margin: 6px 0; }
    .price-per { font-size: 16px; font-weight: 500; display: block; }
    .cta-subtitle { margin-top: calc(var(--spacing) * 3); color: var(--cream); }
    .sr-only {position:absolute;left:-10000px;top:auto;width:1px;height:1px;overflow:hidden;}
  </style>
</head>
<body>
  <div class="content">
    <div class="header-section">
      <h1>Escape Game / Course d'Orientation Aventure en Plein Air et en Autonomie</h1>
      <p class="description">
        DÃ©couvrez une expÃ©rience unique mÃªlant technologie et nature ! RÃ©solvez des Ã©nigmes interactives, explorez des environnements immersifs et vivez des moments inoubliables en famille ou entre amis â€” mÃªme hors-ligne.
      </p>
    </div>

    <!-- Unique CTA: the 3â‚¬ badge is the button -->
    <div class="cta-section">
      <button id="buyBtn" class="price-badge" aria-label="Payer 3 euros par personne et commencer">
        <span class="price-text">Seulement</span>
        <span class="price-amount">3â‚¬</span>
        <span class="price-per">par personne</span>
      </button>
      <p class="cta-subtitle">âœ¨ Cliquez pour commencer l'aventure âœ¨</p>
    </div>
  </div>

  <script>
    // ðŸ‘‰ Replace with your Cloud Function HTTPS URL once deployed
    const SCRIPT_URL = "https://YOUR-REGION-YOUR-PROJECT.cloudfunctions.net/clickCounter"; 

    const paymentUrl = "payment.html"; // or your real checkout URL
    const buyBtn = document.getElementById("buyBtn");

    function postClick(payload) {
      // Prefer sendBeacon for reliability on navigation
      try {
        const blob = new Blob([JSON.stringify(payload)], { type: "application/json" });
        const ok = navigator.sendBeacon(SCRIPT_URL, blob);
        if (ok) return Promise.resolve(true);
      } catch (_) {}
      // Fallback to fetch with keepalive
      return fetch(SCRIPT_URL, {
        method: "POST",
        headers: {"Content-Type":"application/json"},
        body: JSON.stringify(payload),
        keepalive: true,
        mode: "cors",
      }).then(() => true).catch(() => false);
    }

    buyBtn.addEventListener("click", async () => {
      buyBtn.disabled = true;      // basic double-click guard
      buyBtn.style.opacity = "0.7";

      // fire-and-forget; we don't block the redirect if it fails
      postClick({
        type: "payment_click",
        page: location.pathname,
        ts: new Date().toISOString(),
        ua: navigator.userAgent
      }).finally(() => {
        window.location.href = paymentUrl;
      });
    });
  </script>
</body>
</html>
